
CREATE TABLE PART(
PID INT PRIMARY KEY,
PNAME VARCHAR(10),
PCOLOR VARCHAR(10)
);

CREATE TABLE SUPPLIER(
SID INT PRIMARY KEY,
SNAME VARCHAR(10),
SADDR VARCHAR(10)
);

CREATE TABLE SUPPLY(
SID INT NOT NULL,
PID INT NOT NULL,
QTY INT,
FOREIGN KEY (SID) REFERENCES SUPPLIER(SID) ON DELETE CASCADE,
FOREIGN KEY (PID) REFERENCES PART(PID) ON DELETE CASCADE,
PRIMARY KEY(SID,PID)

);

INSERT INTO PART(PID,PNAME,PCOLOR) VALUES(1,'BOLTS','RED');
INSERT INTO PART(PID,PNAME,PCOLOR) VALUES(2,'NUTS','RED');
INSERT INTO PART(PID,PNAME,PCOLOR) VALUES(3,'PLUGS','RED');
INSERT INTO PART(PID,PNAME,PCOLOR) VALUES(4,'BOTS','BLUE');
INSERT INTO PART(PID,PNAME,PCOLOR) VALUES(5,'SCREW','BLUE');
INSERT INTO PART(PID,PNAME,PCOLOR) VALUES(6,'DRIVER','SILVER');

INSERT INTO SUPPLIER(SID,SNAME,SADDR) VALUES(1,'ARAV','XX');
INSERT INTO SUPPLIER(SID,SNAME,SADDR) VALUES(2,'JOSHI','YX');
INSERT INTO SUPPLIER(SID,SNAME,SADDR) VALUES(3,'GARRY','YT');
INSERT INTO SUPPLIER(SID,SNAME,SADDR) VALUES(4,'DRUV','PX');
INSERT INTO SUPPLIER(SID,SNAME,SADDR) VALUES(5,'SHARMA','YY');
INSERT INTO SUPPLIER(SID,SNAME,SADDR) VALUES(6,'SINGH','LK');



INSERT INTO SUPPLY(PID,SID,QTY) VALUES(1,1,5);
INSERT INTO SUPPLY(PID,SID,QTY) VALUES(2,2,2);
INSERT INTO SUPPLY(PID,SID,QTY) VALUES(1,2,5);
INSERT INTO SUPPLY(PID,SID,QTY) VALUES(3,3,5);
INSERT INTO SUPPLY(PID,SID,QTY) VALUES(4,3,5);
INSERT INTO SUPPLY(PID,SID,QTY) VALUES(4,5,1);
INSERT INTO SUPPLY(PID,SID,QTY) VALUES(5,4,9);
INSERT INTO SUPPLY(PID,SID,QTY) VALUES(5,6,8);
INSERT INTO SUPPLY(PID,SID,QTY) VALUES(6,6,2);
INSERT INTO SUPPLY(PID,SID,QTY) VALUES(6,5,6);


SELECT * FROM PART;

SELECT* FROM SUPPLIER;

SELECT* FROM SUPPLY;


SELECT *
FROM PART P
WHERE P.PID IN
(
SELECT S.PID
FROM SUPPLY S
WHERE S.SID IN
(
SELECT SP.SID 
FROM SUPPLIER SP
WHERE SP.SNAME = 'ARAV'
)
);


SELECT SP.SNAME
FROM SUPPLIER SP
WHERE SP.SID IN
(
 SELECT S.SID 
 FROM SUPPLY S
 WHERE S.PID IN
 (
 SELECT P.PID
 FROM PART P
 WHERE P.PNAME = 'DRIVER'
 )
 );

DELETE 
FROM PART
WHERE PCOLOR = 'SILVER';

SELECT * FROM PART;

SELECT *
FROM SUPPLIER SP
WHERE SP.SID IN
(
   SELECT S.SID
   FROM SUPPLY S
   GROUP BY S.SID
   HAVING COUNT(S.PID) = 2
);

